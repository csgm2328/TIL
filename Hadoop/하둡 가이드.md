# 하둡 완벽 가이드
* 하둡 에코시스템의 전체를 다룸. 각 기술간의 관계와 기술들의 핵심을 설명
* 하둡 에코시스템
  * 하둡과 관련된 하이브, 스쿱같은 오픈소스 기술들을 모두 결합한 빅데이터 기술 형태
* 하둡의 구성
  * 하둡은 거대한 데이터를 분산시켜 저장할 수 있는 HDFS와 이 데이터를 분석할 수 있는 맵리듀스라는 핵심 컴포넌트로 구성

* __맵 리듀스__
  * 관계형 DB는 변경에 유리(GByte)
  * 맵리듀스는 데이터를 한번 쓰고 여러번 읽는 데 적합(PByte)
  * semi-structure(반구조적)이며 레코드 지향적인 데이터는 맵리듀스 분석용 데이터로 적합
  * 흐름
    * JOB
      * 클라이언트가 수행하는 작업의 기본 단위.
      * 입력 data + 맵리듀스 프로그램 + 설정 정보
      * Map / Reduce Task 로 나뉨
      * 각 태스크는 YARN을 이용해 스케줄링되고 여러 노드에서 실행됨
        * 실패시 다른노드로 재할당
      * 맵리듀스 Input data를 스플릿으로 쪼개고 각 스플릿마다 맵 태스크를 생성하고 스플릿의 각 레코드를 맵함수로 처리
        * 스플릿으로 분리하여 분산처리가 가능해 효율적임
        * 적절한 스플릿크기는 HDFS 블록의 기본 크기인 128MB
      * __실패__
        * 샘플로는 성공해도 클러스터에서 실패한 경우 디버깅이 어렵기 때문에 쉽게 해결할 수 있는 방법이 필요하다
        * 카운터를 만들어 에러에 대한 필요정보를 얻는다
        * 태스크 실패를 일으키는 파일 로컬에서 문제 재현하기
        * 실패의 주된 이유는 JVM의 메모리부족
          * 해결: mapred.child.java.opts 속성에 옵션 추가
        * 

      * 환경설정 파일(config)
        * addResource()로 여러개 설정파일 추가가능
        * 활용: final 속성으로 관리자가 클라이언트 설정파일이나 잡 재출 매개변수를 사용자가 변경못하도록 데몬 사이트 파일의 속성 final로 지정가능
        * 시스템 속성이 리소스 설정보다 우선순위임
      * 테스트
        * 로컬 드라이버 테스트
        * 미니 클러스터 테스트
          * 단일 프로세스 클러스터 생성 가능
          * 로컬 테스트와 달리 HDFS, 맵리듀스, YARN과 똑같은 환경에서 테스트
          * 이 클러스터의 노드매니저가 별도의 JVM을 실행해 태스크를 실행하므로 디버깅 어려워진다
      * 분산 환경
        * 모든 클래스를 로컬에 있으면 되는 로컬과 달리
        * 분산환경은 필요한 모든 클래스를 JAR파일에 패키징해서 클러스터로 보내야함
        * ant or maven으로 jar파일 생성
      * 로그
        * 표준 출력, 표준 에러에 관련되 모든 로그는 기록됨
        * 클러스터 JVM 디버깅하고 싶을떈 level=DEBUG, console로 확인가능
      * 성능(튜닝)
        * 매퍼 수(매퍼 수 줄이기), 리듀서 수 두개이상인지 체크, 컴바이너 사용가능한지, 맵 출력 압축, 커스텀 직렬화 구현했느지, 셔플 튜닝
  * 맵리듀스 동작 분석
    * 실행 흐름
      * 잡 제출
        * 리소스 매니저에게 앱 ID 얻어서 입력 스플릿 계산하고 공유파일 시스템에 잡 리소스 복사
        * 리소스 매니저에게 잡 제출
      * 잡 초기화
        * 리소스매니저가 YARN 스케줄러에 요청 전달
        * 스케줄러가 컨테이너 하나 할당
        * 앱 마스터 프로세스 시작
        * 상황에 적합한 우버태스크로 할당가능한지
      * 태스크 할당
        * 우버태스크가 아니라면 잡의 모든 맵,리듀스 태스크를 위한 컨테이너 요청(앱 마스터가 리소스 마스터에게)
        * 리듀스 태스크와 달리 맵 태스크는 데이터 지역성 제약 있음
          * 입력 스플릿 저장된 노드에서 맵태스크가 실행되는것이 최적
      * 태스크 실행
        * 노드매니저와 통신해서 컨테이너 시작
        * 필요한 리소스 로컬로 가져와서 맵,리듀스 탯흐크 실제 실행

    * 모니터링
      * 앱 마스터와 각 태스크 프로세스와 인터페이스 통신한다
      * getJobStatus()

* __YARN( Yet Another Resource Negotiator)__
  * 클러스터 자원 관리 시스템
  * 맵리듀스뿐만 아니라 분산프로그램이 하둡 클러스터에 저장된 데이터 처리 할 수 있게 해줌
  * 